# Структура проекта AI Mediator

## Обзор

Проект организован как монолитное приложение. Вся бизнес-логика, интеграции и транспортные уровни находятся в одном репозитории и запускаются из единой точки входа.

## Основные директории

### Корневые файлы
```
├─ README.md            # Основная документация
├─ pyproject.toml       # Зависимости и метаданные проекта
├─ docker-compose.yml   # Локальная разработка
├─ Makefile             # Автоматизация задач
└─ uv.lock              # Файл блокировок зависимостей (uv)
```

### Приложение (main/)
```
main/
├─ __init__.py
└─ main.py              # Единая точка входа монолита
```

### Внутренняя логика (internal/)
```
internal/
├─ config/              # Конфигурация и настройки
│  ├─ __init__.py
│  └─ config.py         # Загрузка переменных окружения и настроек
├─ domain/              # Сущности и модели предметной области
│  └─ __init__.py
├─ transport/           # Транспортные адаптеры
│  ├─ __init__.py
│  └─ telegram/         # Обработчики Telegram
│     └─ __init__.py
├─ service/             # Бизнес-логика (приложенческий слой)
│  └─ __init__.py
├─ repository/          # Доступ к данным
│  ├─ __init__.py
│  └─ postgres/         # Реализации репозиториев для PostgreSQL
│     └─ __init__.py
├─ external_services/   # Интеграции с внешними системами
│  ├─ __init__.py
│  └─ llm/              # Подключения к LLM-провайдерам
│     └─ __init__.py
├─ middleware/          # Промежуточные компоненты
│  ├─ __init__.py
│  ├─ error_handler.py  # Централизованная обработка ошибок
│  └─ logging.py        # Структурированное логирование
└─ validation/          # Валидация входных данных
   ├─ __init__.py
   └─ telegram_validator.py
```

### Общие ресурсы (shared/)
```
shared/
├─ prompts/             # Промпты и тестовые кейсы
│  ├─ current/
│  └─ tests/
├─ contracts/           # Схемы входных/выходных данных
└─ database/            # Миграции БД
```

### Инструменты (tools/)
```
tools/
├─ prompt_tester.py     # Тестирование промптов в автономном режиме
└─ prompt_playground.py # Интерактивная песочница
```

### Документация (docs/)
```
docs/
├─ STRUCTURE.md         # Этот файл
└─ DEVELOPMENT.md       # Гайд для разработчиков
```

### Тесты (tests/)
```
tests/
└─ conftest.py
```

## Принципы архитектуры

- Единая точка входа: `main/main.py`.
- Транспортный слой не содержит бизнес-логики и обращается к сервисам.
- Бизнес-логика изолирована в `internal/service/` и использует сущности из `internal/domain/`.
- Доступ к данным инкапсулирован в `internal/repository/`.
- Конфигурация централизована в `internal/config/`.

## Быстрый старт

```bash
# Тестирование промптов без запуска приложения
python tools/prompt_tester.py

# Песочница для быстрых экспериментов с промптами
python tools/prompt_playground.py
```
